<%
# BigBlueButton open source conferencing system - http://www.bigbluebutton.org/.
# Copyright (c) 2018 BigBlueButton Inc. and by respective authors (see below).
# This program is free software; you can redistribute it and/or modify it under the
# terms of the GNU Lesser General Public License as published by the Free Software
# Foundation; either version 3.0 of the License, or (at your option) any later
# version.
#
# BigBlueButton is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.
# You should have received a copy of the GNU Lesser General Public License along
# with BigBlueButton; if not, see <http://www.gnu.org/licenses/>.
%>

<%= render 'shared/room_event' do %>
  <%= form_for room_path(@room), method: :post do |f| %>
    <div class="input-group join-input">
      <%= f.text_field :join_name,
          required: true,
          class: "form-control join-form",
          placeholder: t("enter_your_name"),
          value: "#{current_user ? current_user.name : ''}",
          readonly: !current_user.nil? %>
    </div>
    <div id= "pin-error" class="btn-danger">
    </div>
    <div class="input-group ">
      <%= f.text_field :conference_pin,
          required: true,
          class: "form-control join-form",
          placeholder: t("enter_conference_pin")
       %>
    </div>
    <div>
    <%= f.submit t("room.join"), class: "btn btn-primary btn-sm col-sm-3 form-control join-form submit_1" %>
    </div>
  <% end %>
<% end %>


<script>
  $(document).ready(function() {
    $('form').on('submit', function(e){
      var conference_pin  = $('#_adi-uc9-jdc_conference_pin').val();
      var room_pin = '<%= @room.bbb_id %>';
      if(conference_pin == room_pin) {
        return true
      }
      else{
      $('#pin-error').html('invalid conference pin');
      return false
      }
    });
  });
</script>